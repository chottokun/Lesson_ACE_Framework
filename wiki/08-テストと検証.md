# 🧪 8. テストと検証

ACE Frameworkの品質を確保するために、自動テストと手動の検証スクリプトが用意されています。

## 1. 自動テスト (Unit Tests)

`pytest` を使用して、主要コンポーネントの動作を個別に検証します。

```bash
# 全てのテストを実行
uv run pytest

# 特定のファイルをテスト (例: 記憶システム)
uv run pytest tests/test_memory.py
```

### 主なテストファイル
- `tests/test_memory.py`: `ACE_Memory` の追加、検索、バッチ挿入の検証。
- `tests/test_graph_build.py`: LangGraph のワークフロー構築が正しく行われるかの検証。
- `tests/test_background_worker.py`: バックグラウンドでのタスク処理とステータス遷移の検証。

## 2. 手動検証 (Memory Flow Test)

エージェントが「学習」し、その知識を別の場面で「再利用」できるかを確認するための一気通貫テストです。

```bash
uv run python tests/manual_test_memory_flow.py
```

### テストシナリオ: 水差し問題 (Water Jug Puzzle)
このテストは、以下の2ステップで「構造的学習」と「知識の転移」を検証します。

1. **ステップ1: 学習 (Learning)**
   - 質問: 「3Lと5Lのバケツで4Lを量るには？」
   - 期待結果: エージェントが回答し、**Reflector** がその解法を「水差し問題の一般的な戦略」として抽象化して記憶に保存する。

2. **ステップ2: 転移 (Transfer)**
   - 質問: 「同じ考え方を使って、5Lと8Lで2Lを量れますか？」
   - 期待結果: **Curator** がステップ1で保存された「一般的な戦略」を検索・取得し、エージェントがそれを新しい変数（5Lと8L）に適用して回答する。

## 3. ベンチマーク

システムのパフォーマンスを測定するためのツールも含まれています。

```bash
# レスポンスタイムとメモリ使用量の測定
uv run python tests/benchmark_ace.py
```

### 検証項目
- **検索の精度**: ベクトル検索が関連する過去の教訓を正しく拾えているか。
- **バッチ挿入速度**: 大量のドキュメントを登録した際のパフォーマンス。
- **並列実行**: バックグラウンドワーカーが推論プロセスに影響を与えていないか。

---
詳細は [デプロイメントと最適化](./09-デプロイメントと最適化.md) を参照してください。
