# 📁 4. リポジトリ構造

## ディレクトリ構成

```text
ace_rm/
├── src/ace_rm/           # メインソースコード
│   ├── memory/           # ストレージ関連
│   │   ├── core.py       # ACE_Memory (SQLite + FAISS)
│   │   └── queue.py      # TaskQueue (SQLite)
│   ├── agent/            # エージェントロジック
│   │   └── graph.py      # LangGraph定義 (Curator, Agent, Reflector)
│   ├── workers/          # バックグラウンド処理
│   │   └── background.py # BackgroundWorker
│   ├── prompts/          # プロンプト管理
│   │   ├── ja.py         # 日本語プロンプト
│   │   └── en.py         # 英語プロンプト
│   ├── utils/            # ユーティリティ
│   │   └── embedding_manager.py # 埋め込みモデルの管理
│   ├── config.py         # 設定管理
│   ├── ace_framework.py  # ファサード (後方互換用)
│   └── app.py            # Gradio UI アプリケーション
├── tests/                # テストコード
│   ├── manual_test_memory_flow.py # 一気通貫テスト
│   └── ...
├── user_data/            # isolatedモード時のデータ保存先
├── .env                  # 環境変数設定
└── pyproject.toml        # プロジェクト構成と依存関係
```

## 各ディレクトリの役割

### `src/ace_rm/memory/`
長期記憶 (LTM) とタスクキューの実装が含まれます。データの永続化と高速な検索を担います。

### `src/ace_rm/agent/`
LangGraph を使用したエージェントのワークフローが定義されています。対話の各ステップ（思考、行動、反省）をノードとして管理します。

### `src/ace_rm/workers/`
非同期でタスクを処理するワーカーの実装です。LLM を使用して対話を分析し、新しい知識を生成します。

### `src/ace_rm/prompts/`
システムプロンプトを一元管理します。多言語対応のために言語ごとにファイルが分かれています。

### `src/ace_rm/utils/`
埋め込みモデルの読み込みなど、共通して使用される便利な機能を提供します。

---
詳細は [データモデル](./05-データモデル.md) を参照してください。
