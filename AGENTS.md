# 🤖 Vibe Coding AGENTS - GUIDE LINE -

## 🎯 目的（ACE + MFR アプローチ）

本プロジェクトは、LLMエージェントの**長期記憶、文脈理解、継続的学習能力**を強化することを目的としています。

基盤となるのは、[ACE (Agentic Context Engineering) アーキテクチャ](https://github.com/ace-agent/ace)です。
これは、LLMの入力コンテキストを3役割（**Generator: 生成者、Reflector: 分析者、Curator: 選別者**）によるモジュラーなプロセスで進化させ、モデルの性能を継続的に改善する枠組みです。

* **Generator（生成者）**: 新たな推論候補を提案します。
* **Reflector（分析者）**: 推論候補を評価し、洞察を抽出します。
* **Curator（選別者）**: 重要な情報を整理・統合し、**プレイブック（知識ベース）**を更新します。

このACEアーキテクチャに、**MFR（Model-First Reasoning: モデルファースト推論）**を統合します。MFRでは、LLMがまず問題の構造化されたモデル（対象・状態変数・行動・制約など）を明示的に構築してから推論を行う二段階パラダイムを採用し、複雑なタスクでの計画精度と一貫性を高めます。

---

## 🛠️ 環境構築

本プロジェクトでは、Astral製の**uv**ツールを用いてPython仮想環境と依存関係を管理します。

uvは環境ロックと同期を自動化し、例えば`uv run`実行時に`pyproject.toml`の変更を反映して環境を最新に保ちます。

⚠️ **注意:**
依存パッケージの追加・削除は**uvコマンド**で行い、手動で`requirements.txt`を編集しないでください。

💡 **DB設定の推奨**: Reflectorやバックグラウンドワーカーを導入する場合、SQLiteの `PRAGMA journal_mode=WAL;` を有効にしておくことを推奨します。これにより、Curator（読み取り）とワーカー（書き込み）が高並列で動作しやすくなります。また、Reflector用の永続的タスクキュー（`task_queue` テーブル）を導入すると、再起動時のタスク損失を防げます。

### 依存関係の追加・管理例

| アクション | コマンド例 | 備考 |
| --- | --- | --- |
| **パッケージ追加** | `uv add pandas` | 通常の依存関係 |
| **開発用パッケージ追加** | `uv add --dev pytest ruff mypy` | テスト、静的解析ツールなど |

---

## 📚 参考ドキュメント

`docs/`ディレクトリを参照し実装すること。

* 設計メモ
* 参考資料
* サンプルコード

> ⚠️ **注意:**
> 実装済みのソースコードや最終的な`README`は含めず、あくまで**参照用の資料**として使用します。

---

## ✅ テストと静的解析

### 静的解析 (Lint & Formatter)

Rust製の高速静的解析ツール**Ruff**を使用します。RuffはFlake8やBlackよりも10–100倍高速に動作し、コード品質チェックと自動整形を同時に行えます。

| アクション | コマンド | 目的 |
| --- | --- | --- |
| **コード品質チェック** | `ruff check .` | Linting（構文や潜在的なバグのチェック） |
| **自動整形** | `ruff format .` | Formatting（統一的なコードスタイルへの整形） |

### 単体テスト

**pytest**を用いてテストを実行します。将来的に`tests/`ディレクトリにテストコードを追加した場合は、次のコマンドで全テストを実行します。

```bash
pytest

```

---

## 💻 コーディングスタイルガイドライン

### 開発手法

* **TDD/BDD:** **テスト駆動開発（TDD）**や**振る舞い駆動開発（BDD）**の手法を積極的に取り入れ、まずテストコードを書いてから機能を実装することで信頼性を高めます。

### 型ヒントとドキュメンテーション

* **型ヒント:** 全ての関数定義と主要変数には、[PEP 484](https://peps.python.org/pep-0484/)形式の**型注釈**を記述してください。これにより可読性と保守性が向上し、`mypy`等で静的型チェックが可能になります。
* **ドキュメンテーション (Docstring):** 公開する関数やクラスにはドキュメンテーション文字列（Docstring）を記述します。[Googleスタイル](https://www.google.com/search?q=https://google.github.io/styleguide/pyguide.html%2338-comments-and-docstrings)のDocstringを推奨し、モジュール・関数・クラスの目的や引数・返り値を簡潔に説明してください。

### 命名規則

Pythonの[PEP 8](https://peps.python.org/pep-0008/)に従い、以下のスタイルを採用します。

| 要素 | スタイル | 規則 | 例 |
| --- | --- | --- | --- |
| **変数・関数** | `snake_case` | 小文字の単語をアンダースコアで区切る | `audio_buffer`, `load_config` |
| **クラス** | `PascalCase` | 各単語の先頭を大文字とする (CapWords) | `AceAgent`, `MfrModel` |
| **定数** | `UPPER_SNAKE_CASE` | 全て大文字で単語をアンダースコアで区切る | `SAMPLE_RATE`, `MAX_ITERATION` |
